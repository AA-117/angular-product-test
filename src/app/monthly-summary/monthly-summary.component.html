<div class="filter-container">
  <mat-form-field appearance="outline" class="date-field">
    <mat-label>Startdatum</mat-label>
    <input
      matInput
      [matDatepicker]="startPicker"
      [(ngModel)]="startDate"
      readonly
    />
    <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
    <mat-datepicker #startPicker></mat-datepicker>
  </mat-form-field>

  <mat-form-field appearance="outline" class="date-field">
    <mat-label>Enddatum</mat-label>
    <input
      matInput
      [matDatepicker]="endPicker"
      [(ngModel)]="endDate"
      readonly
    />
    <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
    <mat-datepicker #endPicker></mat-datepicker>
  </mat-form-field>

  <button mat-raised-button color="primary" class="action-button" (click)="filterTransactions()">
    Anzeigen
  </button>

  <mat-form-field appearance="outline" class="month-field">
    <mat-label>Monat auswählen</mat-label>
    <input
      matInput
      [matDatepicker]="monthPicker"
      [(ngModel)]="selectedMonth"
      (dateChange)="filterTransactionsByMonth()"
      readonly
    />
    <mat-datepicker-toggle matSuffix [for]="monthPicker"></mat-datepicker-toggle>
    <mat-datepicker #monthPicker startView="multi-year" (monthSelected)="chosenMonthHandler($event, monthPicker)" panelClass="month-picker" ></mat-datepicker>
  </mat-form-field>

</div>

<table mat-table [dataSource]="filteredTransactions" class="mat-elevation-z8 tab-body" *ngIf="filteredTransactions.length > 0">

  <ng-container matColumnDef="category">
    <th mat-header-cell *matHeaderCellDef>Kategorie</th>
    <td mat-cell *matCellDef="let tx">{{ tx.category }}</td>
  </ng-container>

  <ng-container matColumnDef="date">
    <th mat-header-cell *matHeaderCellDef>Datum</th>
    <td mat-cell *matCellDef="let tx">{{ tx.date }}</td>
  </ng-container>

  <ng-container matColumnDef="amount">
    <th mat-header-cell *matHeaderCellDef>Betrag</th>
    <td mat-cell *matCellDef="let tx">{{ tx.type === 'output' ? '+' : '-'}}{{ tx.amount | number: '1.2-2' }} €</td>
  </ng-container>

  <ng-container matColumnDef="description">
    <th mat-header-cell *matHeaderCellDef>Beschreibung</th>
    <td mat-cell *matCellDef="let tx">{{ tx.description || '-' }}</td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="['category', 'date', 'amount', 'description']"></tr>
  <tr mat-row *matRowDef="let row; columns: ['category', 'date', 'amount', 'description']"></tr>
</table>

<p *ngIf="filteredTransactions.length === 0">
  Keine Transaktionen im ausgewählten Zeitraum gefunden.
</p>
